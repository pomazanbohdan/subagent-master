# Unified Metrics and Timeouts Configuration
# Standardized metrics and timeout values across all system components

metadata:
  name: "unified-metrics-timeouts"
  version: "0.0.1"
  description: "Unified metrics and timeout configuration for system consistency"
  author: "Master Agent System v0.0.1"

# Standardized Timeout Values
timeout_values:
  # System-level timeouts
  system_initialization:
    default: 30
    development: 60
    testing: 45
    production: 15
    critical: 10
    description: "System initialization and configuration loading"

  task_analysis:
    default: 15
    development: 30
    testing: 20
    production: 10
    critical: 5
    description: "Task complexity analysis and classification"

  agent_selection:
    default: 10
    development: 20
    testing: 15
    production: 5
    critical: 3
    description: "Agent selection and capability matching"

  task_execution:
    default: 300  # 5 minutes
    development: 600  # 10 minutes
    testing: 180  # 3 minutes
    production: 120  # 2 minutes
    critical: 60  # 1 minute
    description: "Task execution completion timeout"

  fallback_activation:
    default: 60
    development: 120
    testing: 90
    production: 30
    critical: 15
    description: "Claude Code fallback activation timeout"

  error_recovery:
    default: 120
    development: 300
    testing: 180
    production: 60
    critical: 30
    description: "Error recovery and correction timeout"

  mcp_server_timeout:
    default: 30
    development: 60
    testing: 45
    production: 20
    critical: 10
    description: "MCP server operation timeout"

  clarification_workflow:
    default: 180  # 3 minutes
    development: 300  # 5 minutes
    testing: 240  # 4 minutes
    production: 120  # 2 minutes
    critical: 60  # 1 minute
    description: "Interactive clarification workflow timeout"

  parallel_coordination:
    default: 600  # 10 minutes
    development: 900  # 15 minutes
    testing: 450  # 7.5 minutes
    production: 300  # 5 minutes
    critical: 180  # 3 minutes
    description: "Parallel execution coordination timeout"

  deadlock_detection:
    default: 120
    development: 180
    testing: 150
    production: 90
    critical: 45
    description: "Deadlock detection and resolution timeout"

  cache_operations:
    default: 5
    development: 10
    testing: 7
    production: 3
    critical: 1
    description: "Cache read/write operations timeout"

# Performance Metrics Standards
performance_metrics:
  # Response Time Metrics
  response_time_targets:
    system_initialization:
      excellent: "< 10s"
      good: "< 20s"
      acceptable: "< 30s"
      poor: "> 30s"

    agent_selection:
      excellent: "< 2s"
      good: "< 5s"
      acceptable: "< 10s"
      poor: "> 10s"

    task_completion:
      excellent: "< 60s"
      good: "< 120s"
      acceptable: "< 300s"
      poor: "> 300s"

    claude_fallback:
      excellent: "< 30s"
      good: "< 60s"
      acceptable: "< 120s"
      poor: "> 120s"

  # Accuracy Metrics
  accuracy_targets:
    agent_selection_accuracy: "> 0.85"
    task_classification_accuracy: "> 0.80"
    clarification_success_rate: "> 0.90"
    error_recovery_success_rate: "> 0.80"
    fallback_effectiveness: "> 0.75"

  # Efficiency Metrics
  efficiency_targets:
    cache_hit_rate: "> 0.70"
    resource_utilization: "< 0.80"
    parallel_efficiency: "> 1.5x"
    system_overhead: "< 0.20"

  # Quality Metrics
  quality_targets:
    task_completion_quality: "> 0.80"
    user_satisfaction: "> 0.80"
    system_reliability: "> 0.95"
    error_rate: "< 0.10"

# System Health Metrics
health_metrics:
  # Resource Utilization
  resource_metrics:
    cpu_utilization:
      healthy: "< 70%"
      warning: "70-85%"
      critical: "> 85%"

    memory_utilization:
      healthy: "< 75%"
      warning: "75-90%"
      critical: "> 90%"

    disk_utilization:
      healthy: "< 80%"
      warning: "80-90%"
      critical: "> 90%"

    network_bandwidth:
      healthy: "< 60%"
      warning: "60-80%"
      critical: "> 80%"

  # Availability Metrics
  availability_metrics:
    system_availability:
      excellent: "> 99.9%"
      good: "> 99.0%"
      acceptable: "> 95.0%"
      poor: "< 95.0%"

    agent_availability:
      excellent: "> 95%"
      good: "> 85%"
      acceptable: "> 70%"
      poor: "< 70%"

    mcp_server_availability:
      excellent: "> 98%"
      good: "> 90%"
      acceptable: "> 80%"
      poor: "< 80%"

  # Performance Metrics
  performance_metrics:
    throughput:
      excellent: "> 100 tasks/hour"
      good: "> 50 tasks/hour"
      acceptable: "> 20 tasks/hour"
      poor: "< 20 tasks/hour"

    latency:
      excellent: "< 1s average"
      good: "< 3s average"
      acceptable: "< 10s average"
      poor: "> 10s average"

    error_rate:
      excellent: "< 1%"
      good: "< 5%"
      acceptable: "< 15%"
      poor: "> 15%"

# Measurement and Collection
metrics_collection:
  collection_frequency:
    real_time_metrics:
      - "active_task_count"
      - "system_load"
      - "error_rate"
      frequency: "every_5_seconds"

    near_real_time_metrics:
      - "response_times"
      - "throughput"
      - "resource_utilization"
      frequency: "every_30_seconds"

    periodic_metrics:
      - "accuracy_rates"
      - "user_satisfaction"
      - "system_availability"
      frequency: "every_5_minutes"

    daily_metrics:
      - "performance_trends"
      - "error_patterns"
      - "usage_statistics"
      frequency: "daily"

  data_retention:
    real_time_data: "1_hour"
    near_real_time_data: "24_hours"
    periodic_data: "30_days"
    daily_data: "1_year"

  storage_format:
    time_series: "influxdb"
    structured_logs: "elasticsearch"
    metrics_summary: "postgresql"
    alerts: "prometheus"

# Alert Thresholds
alert_thresholds:
  critical_alerts:
    - system_unavailable: "> 30s"
    - error_rate_critical: "> 25%"
    - resource_exhaustion: "> 95%"
    - security_breach: "any"

  warning_alerts:
    - performance_degradation: "> 50% baseline"
    - resource_pressure: "> 80%"
    - increased_error_rate: "> 15%"
    - agent_unavailability: "> 30%"

  info_alerts:
    - system_restarts: "any"
    - configuration_changes: "any"
    - performance_improvements: "any"
    - milestone_reached: "any"

# Environment-Specific Metrics
environment_specific_metrics:
  development:
    focus: "debugging and development efficiency"
    relaxed_thresholds: true
    detailed_logging: true
    performance_profiling: true

  testing:
    focus: "test coverage and reliability"
    strict_thresholds: true
    automated_testing_metrics: true
    regression_detection: true

  production:
    focus: "stability and performance"
    strict_thresholds: true
    real_time_monitoring: true
    predictive_alerting: true

# Claude Code Native Metrics
claude_code_metrics:
  native_execution_metrics:
    tool_usage_frequency: "Track Claude Code tool usage patterns"
    direct_execution_success_rate: "Success rate of direct Claude execution"
    fallback_activation_frequency: "How often Claude fallback is triggered"
    native_vs_agent_performance: "Compare Claude native vs agent performance"

  integration_metrics:
    mcp_server_interaction_time: "Time for MCP server operations"
    parallel_execution_efficiency: "Effectiveness of Claude parallel processing"
    task_delegation_success: "Success rate of Task tool delegation"
    error_recovery_effectiveness: "How well Claude handles system errors"

# Metric Calculation Methods
calculation_methods:
  response_time_calculation:
    method: "percentile_based"
    percentiles: [50, 90, 95, 99]
    outlier_removal: true
    sliding_window: "100_samples"

  accuracy_calculation:
    method: "weighted_average"
    recency_weight: 0.7
    historical_weight: 0.3
    minimum_samples: 10

  efficiency_calculation:
    method: "ratio_based"
    baseline_comparison: true
    time_normalized: true
    resource_adjusted: true

  reliability_calculation:
    method: "uptime_based"
    grace_period: "5_minutes"
    maintenance_exclusion: true
    partial_credit: true

# Integration Points
integration:
  required_imports:
    - "config/core/unified_error_handling.yaml"
    - "config/dynamic/integrated_environment_config.yaml"
    - "config/knowledge-base/unified_agent_selection.yaml"

  exports:
    - "timeout_configurations"
    - "performance_targets"
    - "health_thresholds"
    - "alert_conditions"

  external_systems:
    monitoring: "prometheus/grafana"
    logging: "elasticsearch/kibana"
    metrics: "influxdb/grafana"
    alerting: "alertmanager"

# Quality Assurance
quality_assurance:
  metric_validation:
    data_integrity_checks: true
    range_validation: true
    consistency_checks: true
    outlier_detection: true

  performance_validation:
    metric_collection_overhead: "< 1%"
    storage_efficiency: "optimized"
    query_performance: "< 100ms"
    alert_processing: "< 5s"

# Configuration Management
configuration_management:
  dynamic_updates: true
  hot_reload: true
  version_control: true
  rollback_capability: true

  environment_overrides:
    development: "relaxed_thresholds"
    testing: "strict_validation"
    production: "critical_monitoring"