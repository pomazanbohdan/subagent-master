component:
  name: "system_health_check"
  version: "0.3.1"
  description: "Comprehensive health monitoring and validation for all system components"
  category: "core"
  priority: 3
  status: "stable"

triggers:
  primary:
    keywords: ["health_check", "system_status", "component_health", "validation"]
    patterns: [".*health.*monitor.*", ".*system.*status.*", ".*component.*validation.*"]
    score: 1.0
  secondary:
    keywords: ["diagnostic", "recovery", "performance_check", "availability"]
    score: 0.7
  contextual:
    conditions: ["system_degradation_detected", "component_failure", "performance_issue", "startup_validation"]
    score: 0.5

implementation:
  operations:
    - name: "mcp_ecosystem_health_check"
      method: "connectivity_validation"
      priority: 1
      config:
        check_interval: 60
        timeout: 10
        checks:
          - server_connectivity: "verify connection to all MCP servers"
          - tool_functionality: "test all available tools"
          - performance_standards: "ensure response times within limits"
          - license_compliance: "validate all licenses and permissions"
        success_criteria: "all_checks_pass"
        failure_handling: "degraded_mode_activation"
      output:
        mcp_health_score: "float"
        connectivity_status: "object"
        performance_metrics: "object"

    - name: "analysis_components_health_check"
      method: "component_functionality_validation"
      priority: 2
      config:
        check_interval: 30
        timeout: 5
        components:
          - name: "task_analysis"
            tests: ["analysis_accuracy", "performance_validation"]
          - name: "agent_selection"
            tests: ["selection_algorithm_verification", "matching_confidence"]
          - name: "clarification"
            tests: ["clarification_workflow", "question_effectiveness"]
        success_criteria: "all_components_operational"
        failure_handling: "fallback_to_basic_mode"
      output:
        analysis_health_score: "float"
        component_status: "object"
        performance_data: "object"

    - name: "execution_systems_health_check"
      method: "execution_efficiency_validation"
      priority: 3
      config:
        check_interval: 15
        timeout: 3
        components:
          - name: "todo_engine"
            metrics: ["task_delegation_success", "completion_rates"]
          - name: "coordination"
            metrics: ["parallel_execution_efficiency", "resource_utilization"]
          - name: "delegation"
            metrics: ["agent_communication", "response_times"]
        success_criteria: "execution_systems_operational"
        failure_handling: "graceful_degradation"
      output:
        execution_health_score: "float"
        system_efficiency: "object"
        delegation_status: "object"

    - name: "discovery_systems_health_check"
      method: "discovery_functionality_validation"
      priority: 4
      config:
        check_interval: 120
        timeout: 10
        components:
          - name: "agent_registry"
            tests: ["agent_discovery", "registration_success"]
          - name: "batch_orchestrator"
            tests: ["batch_processing", "detection_accuracy"]
        success_criteria: "discovery_systems_operational"
        failure_handling: "manual_intervention_required"
      output:
        discovery_health_score: "float"
        registry_status: "object"
        orchestration_performance: "object"

    - name: "health_scoring_calculation"
      method: "weighted_scoring_algorithm"
      priority: 5
      config:
        weight_distribution:
          critical_components: 0.4
          important_components: 0.3
          supporting_components: 0.2
          optional_components: 0.1
        health_levels:
          excellent:
            threshold: "> 0.95"
            action: "normal_operation"
          good:
            threshold: "0.90 - 0.95"
            action: "monitor_closely"
          acceptable:
            threshold: "0.80 - 0.90"
            action: "initiate_optimization"
          poor:
            threshold: "< 0.80"
            action: "emergency_protocols"
          critical:
            threshold: "< 0.70"
            action: "emergency_intervention"
        alert_thresholds:
          error_rate: 0.05
          performance_degradation: 0.20
          component_failure_rate: 0.10
          resource_exhaustion: 0.85
      output:
        overall_health_score: "float"
        health_level: "string"
        recommended_actions: "array"
        alert_status: "object"

    - name: "health_recovery_system"
      method: "automated_recovery_procedures"
      priority: 6
      config:
        automatic_recovery:
          enabled: true
          strategies:
            - component_restart
            - dependency_refresh
            - configuration_reload
            - system_reboot
          max_attempts: 3
          recovery_timeout: 30
        manual_recovery:
          enabled: true
          procedures:
            - component_isolation
            - system_diagnostic
            - expert_intervention
            - vendor_support
        graceful_degradation:
          enabled: true
          strategies:
            - reduce_functionality
            - switch_to_backup
            - emergency_mode
            - safe_shutdown
      output:
        recovery_status: "string"
        recovery_actions: "array"
        system_state: "object"

dependencies:
  required:
    - component: "monitoring_system"
      version: ">=0.3.1"
      reason: "Health metrics collection and aggregation"
    - component: "error_handling_initialization"
      version: ">=0.3.1"
      reason: "Error handling during health checks"
    - component: "mcp_server_discovery"
      version: ">=0.3.1"
      reason: "MCP ecosystem health validation"
  optional:
    - component: "configuration_base"
      version: ">=0.3.1"
      fallback: "use basic health validation"
      reason: "Configuration health tracking"

output:
  format: "structured"
  validation: true
  schema:
    system_health_score: "float"
    component_health_status: "object"
    active_alerts: "array"
    recovery_status: "string"
    health_check_timestamp: "string"

fallback:
  enabled: true
  strategy: "graceful_degradation"
  alternatives:
    - "basic_connectivity_check"
    - "essential_component_validation"
    - "manual_health_monitoring"
  emergency_only: false
  error_recovery:
    max_retries: 3
    backoff_strategy: "exponential"
    base_delay: 1000
    max_delay: 8000

monitoring:
  enabled: true
  metrics:
    - "health_check_duration"
    - "component_response_time"
    - "health_score_trends"
    - "recovery_action_success"
    - "alert_generation_time"
    - "system_availability_percentage"
    - "false_positive_rate"
  targets:
    health_check_duration: 30000
    component_response_time: 5000
    alert_generation_time: 5000
    system_availability_percentage: 0.995
    recovery_action_success: 0.95
    false_positive_rate: 0.01
  alerts:
    health_check_duration: 60000
    system_availability_percentage: 0.98
    recovery_action_success: 0.90

integration:
  inputs:
    - "component_status_updates"
    - "performance_metrics"
    - "error_reports"
    - "user_feedback"
  outputs:
    - "health_dashboard"
    - "alerting_system"
    - "recovery_engine"
    - "maintenance_scheduler"
  events:
    subscribe: ["component_failure", "performance_degradation", "error_threshold_exceeded"]
    publish: ["health_status_updated", "recovery_initiated", "alert_triggered"]
  apis:
    internal:
      - "perform_health_check"
      - "calculate_health_score"
      - "initiate_recovery"
      - "validate_component_health"
    external:
      - "get_system_health"
      - "get_component_health"
      - "get_health_history"
      - "trigger_manual_health_check"

validation_rules:
  component_validation:
    initialization_complete: true
    functionality_tested: true
    dependencies_satisfied: true
    performance_baseline: true
  system_validation:
    phase_completion: true
    integration_success: true
    performance_targets_met: true
    error_rate_acceptable: true
  monitoring_validation:
    metrics_collection: true
    alert_distribution: true
    dashboard_functionality: true

performance_targets:
  response_time:
    health_check_completion: 30000
    alert_generation: 5000
    dashboard_update: 10000
    report_generation: 60000
  reliability:
    system_availability: 0.995
    health_check_success_rate: 0.98
    recovery_success_rate: 0.95
    false_positive_rate: 0.01
  resource_usage:
    memory_usage_during_checks: 104857600  # 100MB
    cpu_usage_during_checks: 0.40
    network_usage_during_checks: "minimal"

configuration:
  health_check_frequency:
    comprehensive_check: 300  # 5 minutes
    component_health: 60      # 1 minute
    performance_monitoring: 5  # Real-time
    alert_validation: 0      # On trigger
  adaptive_monitoring:
    enabled: true
    load_based_adjustment: true
    performance_based_adjustment: true
    issue_based_adjustment: true
  reporting_schedule:
    daily_health_report: "00:00 UTC"
    weekly_performance_report: "Sunday 23:00 UTC"
    monthly_system_assessment: "Last day 22:00 UTC"
    immediate_alert: "on_critical_issue"