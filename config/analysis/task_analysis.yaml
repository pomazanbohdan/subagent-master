# Task Analysis System (Optimized v1.0.0)
# Task classification, complexity assessment, and execution strategy determination

component:
  name: "task_analysis"
  version: "1.0.0"
  description: "Task analysis system with complexity assessment, domain classification, and execution strategy determination"
  category: "analysis"
  priority: 1  # Critical for task orchestration
  status: "stable"

triggers:
  primary:
    keywords: ["task", "analyze", "complexity", "classification", "execution", "strategy"]
    patterns: [".*analyze.*task.*", ".*task.*complexity.*", ".*execution.*strategy.*"]
    score: 1.0
  secondary:
    keywords: ["planning", "assessment", "coordination", "delegation"]
    patterns: [".*plan.*task.*", ".*assess.*complexity.*", ".*coordinate.*execution.*"]
    score: 0.7
  contextual:
    conditions:
      - "task_received_for_processing"
      - "complexity_assessment_needed"
      - "execution_planning_required"
    score: 0.5

implementation:
  operations:
    - name: "complexity_scoring"
      method: "multi_factor_analysis"
      priority: 1
      config:
        scoring_factors:
          component_count:
            weight: 0.25
            scoring:
              single: 0.2
              few_2_3: 0.4
              moderate_4_5: 0.6
              many_6plus: 1.0
          dependencies:
            weight: 0.20
            scoring:
              external: 0.5
              internal: 0.2
              circular: 1.0
              unknown: 0.8
          uncertainty:
            weight: 0.20
            scoring:
              clear: 0.0
              minor_ambiguity: 0.3
              moderate: 0.6
              high: 1.0
              critical: 1.5
          integration:
            weight: 0.15
            scoring:
              none: 0.0
              single_system: 0.3
              multi_system: 0.8
              cross_functional: 1.2
              enterprise: 1.5
          resources:
            weight: 0.10
            scoring:
              minimal: 0.0
              standard: 0.2
              specialized: 0.5
              critical: 0.8
              limited: 1.0
          historical_patterns:
            weight: 0.10
            scoring:
              successful_similar: -0.2
              failed_similar: 0.3
              no_patterns: 0.0
              confident_patterns: -0.1
        calculation:
          base_score: 1.0
          normalization: "clamp_to_1_5_range"
          confidence_calculation: "1.0 - (uncertainty * 0.3) - (missing_info * 0.4)"
      output:
        complexity_score: "float (1.0-5.0)"
        confidence_level: "float (0.0-1.0)"
        factor_breakdown: "object"

    - name: "domain_classification"
      method: "keyword_pattern_matching"
      priority: 2
      config:
        domains:
          backend:
            keywords: ["api", "backend", "server", "database", "microservice", "infrastructure", "rest", "graphql", "sql", "nosql", "authentication", "authorization", "endpoint", "service"]
            patterns: ["build.*api", "design.*backend", "create.*server", "implement.*database", "setup.*endpoint", "configure.*service"]
            complexity_tendency: 2.0-3.5
            agent_prefs: ["backend-developer", "backend-architect", "full-stack"]
          frontend:
            keywords: ["frontend", "ui", "ux", "react", "vue", "angular", "web", "css", "javascript", "html", "responsive", "component", "interface", "design"]
            patterns: ["build.*ui", "design.*frontend", "create.*web.*app", "implement.*react", "design.*interface", "create.*component"]
            complexity_tendency: 2.0-3.5
            agent_prefs: ["frontend-developer", "ui-designer", "full-stack"]
          devops:
            keywords: ["devops", "infrastructure", "deployment", "ci/cd", "docker", "kubernetes", "terraform", "jenkins", "pipeline", "monitoring", "cloud", "aws", "azure", "gcp"]
            patterns: ["deploy.*application", "setup.*ci", "configure.*kubernetes", "implement.*pipeline", "setup.*infrastructure", "configure.*cloud"]
            complexity_tendency: 2.5-4.0
            agent_prefs: ["devops-engineer", "infrastructure-architect", "cloud-specialist"]
          security:
            keywords: ["security", "vulnerability", "penetration", "compliance", "audit", "authentication", "authorization", "encryption", "firewall", "secure", "protect"]
            patterns: ["security.*audit", "penetration.*test", "implement.*security", "compliance.*check", "secure.*application", "protect.*data"]
            complexity_tendency: 3.0-4.5
            agent_prefs: ["security-engineer", "security-analyst", "compliance-specialist"]
          testing:
            keywords: ["testing", "qa", "quality", "automation", "test", "validate", "verify", "inspect", "coverage", "unit", "integration", "e2e"]
            patterns: ["write.*test", "automate.*testing", "quality.*assurance", "validate.*functionality", "test.*coverage", "implement.*test.*suite"]
            complexity_tendency: 1.5-3.0
            agent_prefs: ["testing-specialist", "qa-engineer", "quality-analyst"]
          data_science:
            keywords: ["data", "analytics", "machine", "learning", "statistics", "visualization", "python", "r", "sql", "dataset", "analysis", "model", "algorithm"]
            patterns: ["analyze.*data", "build.*model", "visualize.*insights", "process.*statistics", "implement.*algorithm", "train.*model"]
            complexity_tendency: 2.0-4.0
            agent_prefs: ["data-scientist", "ml-engineer", "data-analyst"]
          documentation:
            keywords: ["documentation", "writing", "technical", "api.*docs", "manual", "readme", "guide", "specification", "wiki", "knowledge"]
            patterns: ["write.*documentation", "create.*guide", "update.*readme", "document.*process", "create.*specification", "build.*wiki"]
            complexity_tendency: 1.0-2.0
            agent_prefs: ["technical-writer", "documentation-specialist", "knowledge-manager"]
        cross_domain:
          detection_threshold: 0.6
          complexity_adjustments:
            two_domains: 0.3
            three_domains: 0.6
            four_plus: 1.0
      output:
        primary_domain: "string"
        secondary_domains: "array"
        cross_domain_score: "float"
        domain_complexity_adjustment: "float"

    - name: "priority_assessment"
      method: "dynamic_scoring"
      priority: 3
      config:
        priority_levels:
          critical:
            indicators: ["production", "critical", "security", "compliance", "blocker", "emergency", "urgent", "immediate"]
            impact_multiplier: 2.0
            urgency_weight: 1.5
          high:
            indicators: ["high", "priority", "important", "major", "significant", "business"]
            impact_multiplier: 1.5
            urgency_weight: 1.0
          medium:
            indicators: ["medium", "normal", "regular", "standard", "typical"]
            impact_multiplier: 1.0
            urgency_weight: 0.75
          low:
            indicators: ["low", "minor", "nice.*to.*have", "optional", "enhancement", "improvement"]
            impact_multiplier: 0.5
            urgency_weight: 0.5
        dynamic_adjustments:
          complexity:
            high: 0.5
            critical: 1.0
            simple: -0.2
          domain:
            security: 1.0
            performance: 0.5
            production: 0.8
            documentation: -0.3
          time_sensitivity:
            urgent: 1.0
            normal: 0.0
            long_term: -0.5
          resources:
            high_availability: 0.2
            limited: 0.5
            expert_required: 0.3
      output:
        priority_level: "string"
        priority_score: "float"
        priority_factors: "object"

    - name: "resource_analysis"
      method: "requirement_assessment"
      priority: 4
      config:
        resource_types:
          human:
            indicators: ["manual", "review", "approval", "decision", "human.*interaction", "supervision", "management", "leadership"]
            impact_scoring:
              manual_review: 1.0
              human_decision: 0.8
              team_coordination: 0.6
              user_interaction: 0.3
              expert_consultation: 0.5
          computational:
            indicators: ["compute", "process", "analyze", "calculate", "algorithm", "model", "train", "simulate"]
            impact_scoring:
              heavy_computation: 1.5
              model_training: 2.0
              data_processing: 1.0
              algorithm_complexity: 0.8
              simulation: 1.2
          data:
            indicators: ["data", "information", "dataset", "database", "storage", "backup", "migration"]
            impact_scoring:
              large_datasets: 1.0
              database_operations: 0.8
              data_migration: 1.5
              data_analysis: 0.6
              real_time_data: 0.7
          external:
            indicators: ["api", "external", "third.*party", "integration", "service", "web", "dependency"]
            impact_scoring:
              external_api: 0.5
              third_party: 1.0
              web_service: 0.8
              external_data: 0.6
              vendor: 0.4
          creative:
            indicators: ["design", "creative", "innovative", "brainstorm", "ideate", "prototype", "concept"]
            impact_scoring:
              creative_design: 0.4
              innovation: 0.6
              prototype: 0.8
              concept_exploration: 0.3
              ui_ux: 0.5
      output:
        resource_requirements: "object"
        resource_impact_score: "float"
        resource_types_needed: "array"

    - name: "execution_strategy"
      method: "strategy_selection"
      priority: 5
      config:
        strategy_matrix:
          complexity_1:
            delegation: true
            method: "mcp_tools_or_single_agent"
            parallel: false
            human_interaction: false
            coordination: "minimal"
          complexity_2:
            delegation: true
            method: "single_agent_optimal"
            parallel: false
            human_interaction: false
            coordination: "low"
          complexity_3:
            delegation: true
            method: "sequential_or_hybrid"
            parallel: false
            human_interaction: true
            coordination: "medium"
          complexity_4:
            delegation: true
            method: "parallel_decomposition"
            parallel: true
            human_interaction: true
            coordination: "high"
          complexity_5:
            delegation: true
            method: "parallel_execution"
            parallel: true
            human_interaction: true
            coordination: "expert"
        delegation_criteria:
          automatic:
            - "complexity_score >= 2.0"
            - "task_clarity_is_clear"
            - "agents_match_requirements"
            - "confidence > 0.6"
          manual:
            - "high_ambiguity_detected"
            - "critical_task_identified"
            - "user_requests_clarification"
            - "insufficient_capabilities"
            - "multi_domain_coordination"
        parallel_conditions:
          independent_components: true
          resource_availability: true
          performance_optimization: true
      output:
        execution_strategy: "string"
        delegation_readiness: "boolean"
        parallel_execution: "boolean"
        coordination_complexity: "string"

    - name: "batch_detection"
      method: "pattern_recognition"
      priority: 6
      config:
        enabled: true
        detection:
          operation_patterns:
            - "Read file_path"
            - "Edit file_path + old_string + new_string"
            - "Grep pattern + path"
            - "Write file_path + content"
            - "Glob pattern"
            - "Bash command"
          batch_criteria:
            min_identical_ops: 3
            max_operation_types: 6
            similarity_threshold: 0.8
            independence_validation: true
            performance_target: 0.6
          triggers:
            automatic_threshold: 3
            user_keywords: ["batch", "multiple", "parallel", "bulk"]
            scan_types: ["file_operations", "text_modifications", "search_operations"]
        batch_types:
          parallel_file_reading:
            pattern: "Read file_path"
            max_concurrent: 8
            improvement: 0.8
            safety: ["file_access_validation", "permission_check"]
          parallel_text_replacements:
            pattern: "Edit file_path + old_string + new_string"
            max_concurrent: 6
            improvement: 0.7
            safety: ["pattern_validation", "backup_verification", "overlap_prevention"]
          parallel_pattern_searching:
            pattern: "Grep pattern + path"
            max_concurrent: 8
            improvement: 0.75
            safety: ["path_validation", "resource_limits_check"]
          parallel_file_creation:
            pattern: "Write file_path + content"
            max_concurrent: 5
            improvement: 0.65
            safety: ["path_conflict_check", "disk_space_validation"]
      output:
        batch_detected: "boolean"
        operation_type: "string"
        batch_size: "integer"
        confidence_score: "float"
        estimated_savings: "float"
        recommended_strategy: "string"

dependencies:
  required:
    - component: "tfidf_system"
      version: ">=1.0.0"
      reason: "Text similarity and semantic analysis"
  optional:
    - component: "historical_data"
      version: ">=1.0.0"
      fallback: "use default scoring weights"
    - component: "learning_module"
      version: ">=1.0.0"
      fallback: "disable adaptive learning"

output:
  format: "structured"
  validation: true
  schema:
    complexity_score: "float (1.0-5.0)"
    confidence_level: "float (0.0-1.0)"
    domain_classification: "string"
    cross_domain_indicators: "array"
    priority_level: "string"
    resource_requirements: "object"
    execution_strategy: "string"
    estimated_effort: "string"
    delegation_readiness: "boolean"
    batch_detection_result: "object"

fallback:
  enabled: true
  strategy: "graceful_degradation"
  alternatives:
    - "simple_keyword_classification"
    - "rule_based_complexity_scoring"
    - "default_execution_strategy"
  emergency_only: false

monitoring:
  enabled: true
  metrics:
    - "analysis_processing_time"
    - "classification_accuracy"
    - "complexity_scoring_consistency"
    - "strategy_effectiveness"
    - "batch_detection_success"
  performance_targets:
    response_time: 2000  # ms
    accuracy: 0.85
    confidence: 0.80
    batch_efficiency: 0.70

integration:
  inputs:
    - "user_request"
    - "system_state"
    - "agent_registry"
    - "historical_data"
    - "tfidf_analysis"
  outputs:
    - "agent_selection_system"
    - "orchestration_engine"
    - "clarification_system"
    - "batch_processor"
  events:
    - subscribe: "task_received"
    - publish: "task_analyzed"

# Quality Assurance System
quality_assurance:
  validation_rules:
    complexity_range: "1.0-5.0"
    confidence_threshold: 0.6
    domain_match: "detected_patterns"
    resource_realism: "available_resources"
    strategy_match: "task_characteristics"
    delegation_alignment: "complexity_and_clarity"

  consistency_checks:
    historical_validation: true
    system_capability_check: true
    user_expectation_alignment: true
    result_reproducibility: true
    agent_recommendation_validation: true

  performance_metrics:
    processing_time: "< 2 seconds"
    accuracy_rate: "> 85%"
    user_satisfaction: "> 80%"
    error_recovery: "> 90%"
    delegation_success: "> 75%"