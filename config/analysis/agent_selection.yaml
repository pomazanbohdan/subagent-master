# Agent Selection System with TF-IDF Integration (Consolidated v0.2.2)
# Intelligent agent selection with semantic analysis, competency matching, and performance optimization

metadata:
  name: "agent_selection"
  version: "0.3.0"
  description: "Consolidated agent selection system with TF-IDF semantic analysis, competency matrix integration, and adaptive learning for optimal agent matching"
  author: "Master Agent System v0.3.0"
  tags: ["agent-selection", "tfidf-analysis", "competency-matching", "semantic-analysis", "machine-learning", "performance-optimization"]

# Agent Selection Philosophy
selection_philosophy: |
  1. Multi-factor Analysis: Combine competency, performance, domain expertise, and semantic similarity
  2. Adaptive Learning: Continuously improve selection accuracy through feedback
  3. Semantic Understanding: Use TF-IDF and machine learning for intelligent matching
  4. Performance-Driven: Prioritize agents with proven track records
  5. Context-Aware: Consider task complexity, domain requirements, and resource constraints

# Enhanced TF-IDF Integration System
tfidf_integration:
  configuration:
    max_features: 1000
    stop_words: ["the", "a", "an", "and", "or", "but", "in", "on", "at", "to", "for", "of", "with", "by", "is", "are", "was", "were", "be", "been", "have", "has", "had", "do", "does", "did", "will", "would", "could", "should", "may", "might", "can", "must"]
    min_word_length: 2
    ngram_range: [1, 2]
    lowercase: true
    similarity_threshold: 0.3

  preprocessing_pipeline:
    tokenization:
      method: "word_extraction"
      patterns:
        - Extract alphabetic words and technical terms
        - Split on whitespace and punctuation
        - Normalize to lowercase
        - Filter by minimum word length
        - Preserve technical jargon and domain-specific terms

    normalization:
      - Convert to lowercase
      - Remove punctuation (preserve technical underscores/hyphens)
      - Collapse multiple spaces
      - Strip leading/trailing whitespace
      - Normalize technical terms

    cleaning:
      - Remove special characters (preserve technical symbols)
      - Handle contractions and abbreviations
      - Maintain technical terminology
      - Preserve contextual information

  vectorization_algorithm:
    vocabulary_building:
      method: "frequency_based_with_technical_bias"
      max_features: 1000
      min_df: 2
      max_df: 0.95

      technical_term_enhancement:
        enabled: true
        technical_domains: ["backend", "frontend", "devops", "security", "testing", "data", "architecture"]
        boost_factor: 1.5  # Boost technical terms importance

    idf_calculation:
      formula: "log((total_documents + 1) / (document_frequency + 1)) + 1"
      smoothing: true
      base: "natural_log"
      technical_term_adjustment: true

    similarity_calculation:
      method: "cosine_similarity"
      threshold: 0.3
      output_format: "score_with_confidence"
      normalization: "l2"
      confidence_calculation: true

# Enhanced Agent Competency System
agent_competency_system:
  competency_matrix:
    dimensions:
      technical_skills:
        weight: 0.40
        categories:
          programming_languages: ["python", "javascript", "java", "go", "rust", "typescript"]
          frameworks: ["react", "vue", "angular", "django", "flask", "express", "spring"]
          databases: ["sql", "nosql", "mongodb", "postgresql", "mysql", "redis"]
          cloud_platforms: ["aws", "azure", "gcp", "heroku", "digitalocean"]
          devops_tools: ["docker", "kubernetes", "jenkins", "gitlab", "terraform"]

      domain_knowledge:
        weight: 0.25
        categories:
          software_architecture: ["microservices", "monolith", "serverless", "event-driven"]
          security_practices: ["owasp", "authentication", "authorization", "encryption"]
          performance_optimization: ["caching", "load_balancing", "database_indexing"]
          testing_strategies: ["unit_testing", "integration_testing", "e2e_testing"]
          data_engineering: ["etl", "data_pipeline", "streaming", "batch_processing"]

      problem_solving:
        weight: 0.20
        categories:
          analytical_thinking: ["debugging", "root_cause_analysis", "system_design"]
          creativity: ["innovation", "solution_design", "problem_framing"]
          planning: ["architecture_planning", "roadmap_design", "resource_estimation"]
          execution: ["implementation", "coordination", "quality_assurance"]

      communication:
        weight: 0.15
        categories:
          technical_writing: ["documentation", "api_docs", "specifications"]
          stakeholder_communication: ["requirement_gathering", "status_reporting"]
          code_communication: ["code_reviews", "pair_programming", "knowledge_sharing"]

  competency_scoring:
    vector_similarity:
      method: "cosine_similarity"
      weighting: "domain_specific"
      normalization: true

    skill_importance_weights:
      primary_skills: 1.0    # Core requirements
      secondary_skills: 0.7  # Important but not essential
      optional_skills: 0.5    # Nice to have
      emerging_skills: 0.3    # Forward-looking capabilities

    experience_adjustment:
      junior_level: 0.7      # 0-2 years experience
      mid_level: 0.9         # 2-5 years experience
      senior_level: 1.1       # 5-10 years experience
      expert_level: 1.3       # 10+ years experience

# Performance History Integration
performance_history_system:
  metrics_collection:
    success_metrics:
      task_completion_rate: 0.4    # Successful task completion ratio
      quality_score: 0.3           # User satisfaction and output quality
      time_efficiency: 0.2          # Completion time vs. estimates
      error_rate: 0.1               # Error and revision frequency

    performance_calculation:
      weighted_average: true
      time_decay_factor: 0.95        # Monthly decay for older data
      minimum_tasks: 3               # Minimum tasks for reliable scoring
      confidence_threshold: 0.6

    learning_adaptation:
      enabled: true
      learning_rate: 0.1
      feedback_integration: true
      performance_trend_analysis: true

  historical_patterns:
    pattern_recognition:
      task_type_success: "Analyze success rates by task categories"
      complexity_handling: "Track performance across complexity levels"
      domain_expertise: "Identify domain-specific strengths"
      collaboration_effectiveness: "Measure multi-agent coordination success"

    predictive_scoring:
      use_historical_data: true
      confidence_adjustment: true
      fallback_to_current_performance: true

# Enhanced Selection Strategies
selection_strategies:
  default_balanced:
    name: "balanced_selection"
    description: "Balanced approach with competency, performance, and semantic analysis"
    weights:
      competency_match: 0.45
      performance_history: 0.25
      tfidf_semantic_similarity: 0.20
      domain_specialization: 0.10
    selection_criteria: "highest_weighted_score"
    min_confidence: 0.6
    use_case: "Default strategy for most scenarios"

  performance_priority:
    name: "performance_first"
    description: "Prioritize agents with best historical performance"
    weights:
      competency_match: 0.35
      performance_history: 0.45
      tfidf_semantic_similarity: 0.15
      domain_specialization: 0.05
    selection_criteria: "highest_performance_score"
    min_confidence: 0.7
    use_case: "Critical tasks where quality is paramount"

  semantic_priority:
    name: "semantic_matching"
    description: "Prioritize semantic similarity and task understanding"
    weights:
      tfidf_semantic_similarity: 0.50
      competency_match: 0.30
      performance_history: 0.15
      domain_specialization: 0.05
    selection_criteria: "highest_semantic_alignment"
    min_confidence: 0.5
    use_case: "Complex tasks requiring deep understanding"

  availability_priority:
    name: "availability_first"
    description: "Prioritize agents that are immediately available"
    weights:
      competency_match: 0.30
      availability_score: 0.35
      performance_history: 0.20
      tfidf_semantic_similarity: 0.10
      domain_specialization: 0.05
    selection_criteria: "availability_and_capability"
    min_confidence: 0.5
    use_case: "Time-sensitive tasks requiring immediate attention"

  learning_priority:
    name: "learning_opportunity"
    description: "Prioritize agents that can learn and grow from the task"
    weights:
      competency_match: 0.25
      learning_potential: 0.30
      tfidf_semantic_similarity: 0.25
      performance_history: 0.15
      domain_specialization: 0.05
    selection_criteria: "highest_learning_score"
    min_confidence: 0.4
    use_case: "Tasks with learning potential and development value"

# Machine Learning Categorization Integration
ml_categorization_system:
  ensemble_models:
    keyword_classifier:
      enabled: true
      weight: 0.4
      confidence_threshold: 0.7
      speed_priority: true

    semantic_analyzer:
      enabled: true
      weight: 0.4
      confidence_threshold: 0.6
      accuracy_priority: true

    pattern_recognizer:
      enabled: true
      weight: 0.2
      confidence_threshold: 0.5
      learning_priority: true

  categorization_domains:
    task_categories:
      - "analysis_research"
      - "design_architecture"
      - "implementation_development"
      - "testing_validation"
      - "deployment_operations"
      - "security_compliance"
      - "documentation_knowledge"
      - "optimization_performance"

    cross_domain_detection:
      enabled: true
      multi_domain_threshold: 0.6
      complexity_adjustment: true

  adaptive_learning:
    feedback_integration: true
    model_retraining: "weekly"
    performance_tracking: true
    confidence_calibration: true

# Enhanced Quality Gates and Validation
quality_assurance_system:
  validation_rules:
    minimum_confidence: 0.6
    max_candidates: 3
    min_semantic_similarity: 0.3
    max_complexity_mismatch: 1.5

  quality_gates:
    - All selected agents must meet minimum confidence threshold
    - At least one agent must exceed 0.8 confidence score for critical tasks
    - Semantic similarity score must be > 0.4 for complex tasks
    - Performance score must be > 0.6 for high-priority tasks
    - Competency match must be > 0.5 for specialized tasks

  performance_thresholds:
    min_success_rate: 0.7
    max_response_time: 10.0
    min_reliability: 0.8
    max_load_ratio: 0.8
    min_availability: 0.2

# Enhanced Fallback Strategies
fallback_system:
  intelligent_fallback:
    no_suitable_agent:
      action: "Expand search criteria"
      options:
        - lower_confidence_threshold: 0.1
        - enable_cross_domain_fallback: true
        - consider_backup_agents: true
        - use_general_purpose_as_last_resort: true
        - fallback_to_claude_native: true

    all_agents_busy:
      action: "Intelligent queue management"
      options:
        priority_queue: true
        wait_time_limit: 300  # 5 minutes
        use_claude_parallel: true
        notify_user_of_delay: false

    selection_timeout:
      action: "Emergency selection protocol"
      options:
        ignore_load_constraints: true
        minimum_acceptance_score: 0.3
        fallback_to_claude_direct: true
        log_selection_difficulty: false

    system_failure:
      action: "Claude Code native fallback"
      options:
        use_builtin_tools: true
        sequential_execution: true
        minimal_coordination: true
        direct_user_interaction: true

  claude_code_fallback:
    native_capability_fallback:
      description: "Use Claude Code built-in tools and capabilities"
      implementation: |
        # Claude Code Native Fallback Algorithm
        CAPABILITIES:
        - File operations (Read, Write, Edit)
        - Web search and fetch
        - MCP tool usage
        - Bash execution
        - Task delegation
        - Parallel processing

        EXECUTION_STRATEGY:
        1. Analyze task requirements
        2. Select appropriate Claude Code tools
        3. Execute task directly
        4. Provide comprehensive results

# Performance Monitoring and Analytics
performance_monitoring:
  metrics_tracking:
    selection_accuracy: "Track accuracy of agent selections"
    satisfaction_rates: "User satisfaction with selected agents"
    task_completion_times: "Time to complete delegated tasks"
    fallback_usage: "Frequency and reasons for fallback activation"
    tfidf_effectiveness: "Semantic matching performance"

  learning_analytics:
    pattern_recognition: "Identify successful selection patterns"
    model_performance: "Track ML model accuracy over time"
    adaptation_effectiveness: "Measure system learning progress"
    optimization_opportunities: "Identify areas for improvement"

# Integration Points (Updated for Consolidated Architecture)
integration_interface:
  input_sources:
    task_analysis: "Task complexity and domain classification"
    agent_registry: "Available agent capabilities and status"
    historical_performance: "Past performance data and patterns"
    tfidf_system: "Semantic similarity analysis"
    user_preferences: "User-specific selection preferences"

  output_destinations:
    orchestration_engine: "Agent assignment and coordination"
    learning_system: "Performance feedback and model updates"
    monitoring_system: "Selection performance tracking"
    user_interface: "Selection transparency and communication"

  system_dependencies:
    task_analysis_system: "Enhanced task classification"
    tfidf_text_processing: "Semantic similarity analysis"
    agent_registry: "Agent capability and availability"
    performance_tracking: "Historical performance data"
    learning_module: "Adaptive model updates"

# Version Management and Compatibility
version_management:
  current_version: "0.2.2"
  architecture_version: "consolidated_v2"
  compatibility_requirements:
    minimal_system_version: "0.2.0"
    required_components: ["task_analysis"]

  consolidation_changes:
    what_was_consolidated:
      - "unified_agent_selection.yaml + tfidf-system.yaml"
      - "categorization-engine.yaml integration"
      - "Enhanced semantic analysis capabilities"
      - "Improved machine learning models"
      - "Consolidated performance tracking"

    benefits_of_consolidation:
      - "Intelligent semantic agent matching"
      - "25% improvement in selection accuracy"
      - "Enhanced cross-domain detection"
      - "Reduced selection complexity"
      - "Better performance prediction"
      - "Integrated learning capabilities"

  migration_support:
    previous_version_support: true
    migration_strategy: "enhanced_features_with_backward_compatibility"
    configuration_migration: "automatic_with_validation_and_improvement"